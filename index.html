<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Our Finances</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            dark: '#2C3E50',       /* Deep Blue */
                            primary: '#3498DB',    /* Trust Blue */
                            accent: '#E67E22',     /* Warm Orange */
                            light: '#F5F7FA',      /* Soft Gray */
                            surface: '#FFFFFF'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', '-apple-system', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #F5F7FA; -webkit-tap-highlight-color: transparent; }
        ::-webkit-scrollbar { width: 0px; background: transparent; }
        .app-container {
            max-width: 480px; margin: 0 auto; min-height: 100vh;
            background: #F5F7FA; position: relative; overflow-x: hidden;
            box-shadow: 0 0 30px rgba(0,0,0,0.05);
        }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Card Gradients */
        .gradient-card { background: linear-gradient(135deg, #2C3E50 0%, #34495E 100%); }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- USER CONFIGURATION (PASTE LINKS HERE) ---
        const CONFIG = {
            // Step 1: Your Google Drive Folder Link (Where you drop PDFs)
            DRIVE_LINK: "PASTE_YOUR_GOOGLE_DRIVE_FOLDER_LINK_HERE", 
            
            // Step 2: Your Google Sheet CSV Link (File > Share > Publish to Web > CSV)
            SHEET_LINK: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTsQy8m6lQ6Ac0vsxe2DMwEFwqc2yfbnOiU_2kGdMlLp8jit-YIbQ620lZtR8RH_UkQ0tn-yddRgFI0/pub?gid=1027697624&single=true&output=csv" 
        };

        // --- Components ---

        const Button = ({ children, onClick, variant = 'primary', className = '' }) => {
            const base = "w-full py-4 rounded-2xl font-bold transition-transform active:scale-95 flex items-center justify-center gap-2 text-sm uppercase tracking-wide";
            const variants = {
                primary: "bg-brand-dark text-white shadow-lg shadow-blue-900/20",
                secondary: "bg-white text-brand-dark border border-slate-200 shadow-sm",
                accent: "bg-brand-accent text-white shadow-lg shadow-orange-500/20"
            };
            return <button onClick={onClick} className={`${base} ${variants[variant]} ${className}`}>{children}</button>;
        };

        const Card = ({ children, className = '' }) => (
            <div className={`bg-white p-6 rounded-3xl shadow-[0_10px_30px_rgba(0,0,0,0.03)] border border-slate-100 ${className}`}>
                {children}
            </div>
        );

        // --- Screens ---

        const HomeScreen = ({ onNavigate, data, loading }) => (
            <div className="h-screen flex flex-col justify-between p-8 fade-in relative">
                <div className="mt-8">
                    <div className="flex justify-between items-center mb-8">
                        <div>
                            <p className="text-xs font-bold text-slate-400 tracking-widest uppercase mb-1">HELLO, US</p>
                            <h1 className="text-3xl font-extrabold text-brand-dark">Finance Tracker</h1>
                        </div>
                        <div className="w-10 h-10 rounded-full bg-brand-primary/10 flex items-center justify-center text-brand-primary">
                            <i className="fa-solid fa-user-group"></i>
                        </div>
                    </div>

                    {/* Quick Stat Card */}
                    <div className="gradient-card p-6 rounded-3xl text-white shadow-xl shadow-blue-900/10 mb-8 relative overflow-hidden">
                        <div className="relative z-10">
                            <p className="text-blue-200 text-xs font-bold uppercase tracking-wider mb-2">This Month's Verdict</p>
                            {loading ? (
                                <p className="animate-pulse opacity-70">Syncing...</p>
                            ) : (
                                <>
                                    <h2 className="text-3xl font-bold mb-1">{data?.verdict || "No Data Yet"}</h2>
                                    <p className="text-2xl opacity-90">{data?.total ? `$${data.total}` : "$0.00"}</p>
                                </>
                            )}
                        </div>
                        {/* Decorative Circle */}
                        <div className="absolute -right-6 -bottom-10 w-32 h-32 bg-white opacity-10 rounded-full"></div>
                    </div>

                    {/* Action Items Preview */}
                    {data?.actions && data.actions.length > 0 && (
                        <div className="space-y-3">
                            <p className="text-xs font-bold text-slate-400 uppercase tracking-wider ml-1">AI Insights</p>
                            {data.actions.slice(0, 2).map((action, i) => (
                                <div key={i} className="bg-white p-4 rounded-2xl border border-slate-100 text-sm text-slate-600 flex gap-3 shadow-sm">
                                    <i className="fa-solid fa-lightbulb text-brand-accent mt-1"></i>
                                    {action}
                                </div>
                            ))}
                        </div>
                    )}
                </div>

                <div className="space-y-3 mb-6">
                    <Button variant="accent" onClick={() => window.open(CONFIG.DRIVE_LINK, '_blank')}>
                        <i className="fa-solid fa-cloud-arrow-up"></i> Upload Statement
                    </Button>
                    <Button variant="secondary" onClick={() => onNavigate('dashboard')}>
                        View Full Analysis
                    </Button>
                </div>
            </div>
        );

        const DashboardScreen = ({ data, onBack }) => {
            if (!data) return <div className="p-8 text-center text-slate-400">Loading Data...</div>;

            const isSaved = data.verdict?.toLowerCase().includes("save");

            return (
                <div className="min-h-screen p-6 fade-in pb-10">
                    <div className="flex items-center mb-8">
                        <button onClick={onBack} className="w-10 h-10 rounded-xl bg-white flex items-center justify-center text-slate-400 shadow-sm border border-slate-100">
                            <i className="fa-solid fa-arrow-left"></i>
                        </button>
                        <h2 className="text-xl font-bold ml-4 text-brand-dark">Dashboard</h2>
                    </div>

                    <Card className="mb-6 text-center py-8">
                        <p className="text-slate-400 text-xs font-bold uppercase tracking-wider mb-2">TOTAL SPENT</p>
                        <h1 className="text-5xl font-extrabold text-brand-dark mb-4">{data.total ? `$${data.total}` : "$0"}</h1>
                        <span className={`px-4 py-2 rounded-full text-xs font-bold uppercase tracking-wide ${isSaved ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>
                            {data.verdict || "Pending"}
                        </span>
                    </Card>

                    <h3 className="text-sm font-bold text-slate-400 uppercase tracking-wide mb-4 ml-1">Action Plan</h3>
                    <div className="space-y-4">
                        {data.actions.map((action, i) => (
                            <div key={i} className="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 flex gap-4">
                                <div className="w-6 h-6 rounded-full bg-brand-primary/10 flex-shrink-0 flex items-center justify-center text-brand-primary text-xs font-bold">
                                    {i + 1}
                                </div>
                                <p className="text-slate-600 text-sm leading-relaxed">{action}</p>
                            </div>
                        ))}
                    </div>

                    <div className="mt-8 text-center">
                        <p className="text-xs text-slate-400">Data sourced from Shared Drive</p>
                    </div>
                </div>
            );
        };

        // --- Main Controller ---

        const App = () => {
            const [view, setView] = useState('home');
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(true);

            // Fetch Real Data from Google Sheets
            useEffect(() => {
                const fetchSheet = async () => {
                    if (CONFIG.SHEET_LINK.includes("PASTE_YOUR")) {
                        // Use Demo Data if user hasn't setup links yet
                        setTimeout(() => {
                            setData({
                                month: "Demo Month",
                                total: "2,450",
                                verdict: "Saved $300",
                                actions: [
                                    "Coffee spending is down 10%. Keep using the home machine.",
                                    "Grocery bill spiked. Check the bulk buy at S&R.",
                                    "Cancel the unused generic streaming subscription."
                                ]
                            });
                            setLoading(false);
                        }, 1000);
                        return;
                    }

                    try {
                        const response = await fetch(CONFIG.SHEET_LINK);
                        const csvText = await response.text();
                        
                        // Parse CSV (Simple Version)
                        const rows = csvText.split('\n').slice(1); // Remove header
                        const lastRow = rows[rows.length - 1]?.split(',') || [];
                        
                        // Assuming CSV columns: Month, Total, Verdict, Action1, Action2, Action3
                        if (lastRow.length > 1) {
                            setData({
                                month: lastRow[0],
                                total: lastRow[1],
                                verdict: lastRow[2],
                                actions: [lastRow[3], lastRow[4], lastRow[5]].filter(Boolean)
                            });
                        }
                        setLoading(false);
                    } catch (e) {
                        console.error("Fetch Error", e);
                        setLoading(false);
                    }
                };
                
                fetchSheet();
            }, []);

            return (
                <div className="app-container">
                    {view === 'home' && <HomeScreen onNavigate={setView} data={data} loading={loading} />}
                    {view === 'dashboard' && <DashboardScreen data={data} onBack={() => setView('home')} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
